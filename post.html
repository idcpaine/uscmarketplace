<!DOCTYPE html>
<html>
	<head>
        <link rel="stylesheet" href="post.css">
		<meta charset="UTF-8">
		<title>Lab 11</title>
	</head>
	<body>
        <button id="backButton" class="button" onclick="backButtonPressed()">
            Back
        </button>

        <div class="post">
            <h1>vintage USC chair</h1>
            <img id='mainImage' width="500" height="600">
            <p id="description">
                description!
            </p>
        </div>



        <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>

        <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-analytics.js"></script>

        <!-- Add Firebase products that you want to use -->
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>

        <script>
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            var firebaseConfig = {
                apiKey: "AIzaSyDggC7QCB9qvUa9sT9DgWn50djUDzR3_T0",
                authDomain: "uscmarketplace.firebaseapp.com",
                projectId: "uscmarketplace",
                storageBucket: "uscmarketplace.appspot.com",
                messagingSenderId: "432656718742",
                appId: "1:432656718742:web:9f34948f88a687987d9bb7",
                measurementId: "G-LSPEZ0QTC0"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            firebase.analytics();
        </script>
        

        <script> 
            //read images from Firebase Storage
            var storage = firebase.storage();

            //for loop iterating through all imagesURLs from the postID
            var imageURL = 'gs://uscmarketplace.appspot.com/post_images/postID/chair.webp';
            var imageRef = storage.refFromURL(imageURL);
            document.getElementById('description').innerHTML = 'hi';
            console.log('hi');


            // Get the download URL
            imageRef.getDownloadURL()
            .then((url) => {
                document.getElementById('mainImage').setAttribute('src', url);
            // Insert url into an <img> tag to "download"
            })
            .catch((error) => {
            // A full list of error codes is available at
            // https://firebase.google.com/docs/storage/web/handle-errors
            switch (error.code) {
                case 'storage/object-not-found':
                    console.log('file doesnt exist');
                // File doesn't exist
                break;
                case 'storage/unauthorized':
                    console.log('User doesn't have permission to access the object');
                // User doesn't have permission to access the object
                break;
                case 'storage/canceled':
                    console.log('User canceled the upload');
                // User canceled the upload
                break;

                case 'storage/unknown':
                    console.log('nknown error occurred, inspect the server response');
                // Unknown error occurred, inspect the server response
                break;
            }
            });
        </script>

        <script>
            function backButtonPressed() {
                //go back to previous page
                console.log('back button pressed');
            }
        </script>
	</body>
</html>