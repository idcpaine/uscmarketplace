<!DOCTYPE html>
<html>
<head>
    <title>Account Page</title>
    <p id='status'>Not Logged In</p>
    <form id="myForm" class="form">
        <div class="form-group">
          <label>First Name</label>
          <input type="text" class="form-control" id="first_name" name="first_name">
        </div>
        <div class="form-group">
            <label>Last Name</label>
            <input type="text" class="form-control" id="last_name" name="last_name">
        </div>
        <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" class="form-control" id="number" name="number" placeholder="(XXX)-XXX-XXXX">
        </div>
        <div class="form-group">
            <label for="year">Status:</label>
            <select id="year" name="year" size="1">
                <option value="null"></option>
                <option value="freshman">Freshman</option>
                <option value="sophomore">Sophomore</option>
                <option value="junior">Junior</option>
                <option value="senior">Senior</option>
                <option value="graduate">Graduate</option>
                <option value="alumni">Alumni</option>
            </select><br><br>
        </div>
        <button id="submit" type="submit"> Submit </button>
    </form>
</head>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-auth.js"></script>
      <script>
        // Your web app's Firebase configuration: You should put your own keys here!
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
           // I inserted the API keys here from the firebase website
        apiKey: "AIzaSyDggC7QCB9qvUa9sT9DgWn50djUDzR3_T0",
        authDomain: "uscmarketplace.firebaseapp.com",
        projectId: "uscmarketplace",
        storageBucket: "uscmarketplace.appspot.com",
        messagingSenderId: "432656718742",
        appId: "1:432656718742:web:9f34948f88a687987d9bb7",
        measurementId: "G-LSPEZ0QTC0"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
        var db = firebase.firestore();

        const accountForm = document.querySelector('#myForm');
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                // User is signed in.
                document.getElementById("status").innerHTML = "Signed in as " + user.email;
                // window.location = '/homepage.html';

                // ...
            } else {
                // User is signed out.
                document.getElementById("status").innerHTML = "Not Logged In";
                // ...
            }
            const accountForm = document.querySelector('#myForm');
            //saving data

            accountForm.addEventListener('submit', (e) => {
                console.log("entered user info");
                //prevents the entire page from being refreshed
                e.preventDefault();
                db.collection('users').doc(user.uid).set({
                    first_name: accountForm['first_name'].value,
                    last_name: accountForm['last_name'].value,
                    phone_number: accountForm['number'].value,
                    status: accountForm['year'].value,
                    date: new Date()
                })
            })
        });
        </script>
</html>